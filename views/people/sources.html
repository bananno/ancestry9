<%- include ../partials/header %>
<% var rootPath = "/person/" + (person.customId || person._id); %>

<div id="content">
    <h1><%= person.name %></h1>

    <ul>
        <li><a href="<%= rootPath %>">summary</a></li>
        <li><a href="<%= rootPath %>/sources">sources</a></li>
        <li><a href="<%= rootPath %>/edit">edit person</a></li>
    </ul>

    <% if (person.parents.length) { %>
        <h3>parents</h3>
        <%- include('../partials/peopleList', { people: person.parents }) %>
    <% } %>

    <% if (siblings.length) { %>
        <h3>siblings</h3>
        <%- include('../partials/peopleList', { people: siblings }) %>
    <% } %>

    <% if (person.spouses.length) { %>
        <h3>spouses</h3>
        <%- include('../partials/peopleList', { people: person.spouses }) %>
    <% } %>

    <% if (person.children.length) { %>
        <h3>children</h3>
        <%- include('../partials/peopleList', { people: person.children }) %>
    <% } %>

    <% if (person.links.length) { %>
        <h3>links</h3>
        <ul>
            <% for (var i = 0; i < person.links.length; i++) { %>
                <li>
                    <%- include('../format/externalLink', { url: person.links[i] }) %>
                </li>
            <% } %>
        </ul>
    <% } %>

    <h2> Tree </h2>

    <%- include('../partials/personTree', { person: person, people: people, safety: 0 }) %>

    <% var addEventPath = rootPath + "/addEvent"; %>

    <h2> Timeline </h2>

    <% if (editView == 'events') { %>
        <%- include('../forms/newEvent', { actionPath: addEventPath, cancelPath: rootPath }) %>
    <% } else if (editView == 'none') { %>
        <p>
            <a href="<%= addEventPath %>" class="main-link">+ Create Event</a>
        </p>
    <% } %>

    <%- include('../events/eventList', { events: events, people: people }) %>

    <h2> Citations </h2>

    <%- include('../partials/citationList', {
        citations: citations,
        showDelete: false,
        showSource: true,
        showPerson: false,
        groupBy: 'item',
    }) %>

</div>
